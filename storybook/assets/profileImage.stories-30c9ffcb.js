import{D as b,A as E,E as p,k as M,a as L,F as y,C as x,c as S,b as A,U as C,g as k}from"./storybook-670e6310.js";import{b as r,M as T,k as R,c as u,e as f,f as U,l as B,u as D,t as $}from"./store-583bd420.js";import{A as z}from"./image-4eb0e5f9.js";import{a as _}from"./eventHelper-afabd18e.js";import{u as H}from"./useValidation-87d2c1f1.js";import{H as O}from"./helpIconTooltip-126e8490.js";import"./_commonjsHelpers-725317a4.js";var i=(e=>(e[e.Pending=0]="Pending",e[e.Loading=1]="Loading",e[e.Success=2]="Success",e[e.Error=3]="Error",e))(i||{});const W=e=>{const n=e.name?.split?.(".")?.pop?.()??".png";return new Promise((g,l)=>{const o=new FileReader;o.onload=async t=>{const s=new Image;if(t.target==null||t.target.result==null){l("e.target.result is null");return}s.src=t.target.result,await s.decode(),g({width:s.width,height:s.height,fileSize:e.size,fileExtension:n})},o.onerror=t=>l(t),o.readAsDataURL(e)})},j=()=>r(b,{size:"lg",thickness:"3px",color:"$primary9"}),q=e=>r(R,{get fallback(){return r(E,{mt:"$3",size:"xl",name:"+",class:"noselect no-drag",draggable:!1,borderRadius:"0.25em",get src(){return e.imageUrl}})},get children(){return[r(T,{get when(){return e.networkState===i.Loading},get children(){return r(p,{pt:"2em",get children(){return r(j,{})}})}}),r(T,{get when(){return e.networkState===i.Error},get children(){return r(M,{})}})]}});var G=$("<input id=file-upload type=file accept=image/*>");const I=(e,n)=>n??(e==null?z.fallbackImg:e?.toString?.()),J=e=>{let n;const[g,l]=H(e.validation),[o,t]=u(I(e.value,e.imageValue)),[s,F]=u(),[P,w]=u(),[V,h]=u(i.Success);f(()=>{e.showValidationMessages===!0&&l({...new File([],""),...s()})},[e.showValidationMessages]),f(async()=>{const a=P();if(a!=null)try{t(URL.createObjectURL(a));const c=await W(a);F(c),l({...a,...c}),e.onChange(a),h(i.Success)}catch{h(i.Error)}finally{w(void 0)}},[P]),f(()=>{e.value==null&&t(I(e.value,e.imageValue))},[e.value]);const v=async a=>{h(i.Loading),w(a)};return r(x,{get children(){return r(L,{direction:"column",class:"img-profile-hover pointer",onClick:()=>n?.click?.(),get children(){return[r(y,{textAlign:"center",get for(){return e.id},get children(){return[U(()=>e.label),r(O,{get helpText(){return e.helpText}})]}}),r(x,{h:"100%",get children(){return r(q,{get imageUrl(){return o()},get networkState(){return V()}})}}),r(p,{display:"none",get children(){var a=G();return B(a,"change",_(v)),D(c=>n=c,a),a}}),r(p,{mt:"$3",textAlign:"center",get children(){return r(S,{get invalid(){return!g().isValid},get children(){return r(A,{textAlign:"center",get children(){return g().errorMessage}})}})}})]}})}})},re={title:"Form/ProfilePic",component:J,decorators:[C],tags:["autodocs"],argTypes:{...k()}},d={args:{label:"Profile Pic",helpText:"This is a help icon with a tooltip",showValidationMessages:!0}},m={args:{label:"Bad Profile Pic",helpText:"This is a help icon with a tooltip",showValidationMessages:!0,validation:()=>({isValid:!1,errorMessage:"example error message"})}};d.parameters={...d.parameters,docs:{...d.parameters?.docs,source:{originalSource:`{
  args: {
    label: 'Profile Pic',
    helpText: 'This is a help icon with a tooltip',
    showValidationMessages: true
  }
}`,...d.parameters?.docs?.source}}};m.parameters={...m.parameters,docs:{...m.parameters?.docs,source:{originalSource:`{
  args: {
    label: 'Bad Profile Pic',
    helpText: 'This is a help icon with a tooltip',
    showValidationMessages: true,
    validation: () => ({
      isValid: false,
      errorMessage: 'example error message'
    })
  }
}`,...m.parameters?.docs?.source}}};const ae=["Basic","ValidationError"];export{d as Basic,m as ValidationError,ae as __namedExportsOrder,re as default};
