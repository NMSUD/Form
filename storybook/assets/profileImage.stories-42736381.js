import{p as b,A as M,q as p,k as E,a as y,F as L,C as x,c as S,b as A,r as C,U as k,g as R}from"./storybook-18e3f4c6.js";import{b as r,M as T,k as U,c as u,e as f,f as B,l as $,u as z,t as D}from"./store-583bd420.js";import{A as _}from"./image-45cd305e.js";import{a as H}from"./eventHelper-856bb71c.js";import{u as O}from"./useValidation-87d2c1f1.js";import{H as q}from"./helpIconTooltip-5c8767b9.js";import"./_commonjsHelpers-725317a4.js";var s=(e=>(e[e.Pending=0]="Pending",e[e.Loading=1]="Loading",e[e.Success=2]="Success",e[e.Error=3]="Error",e))(s||{});const W=e=>{const i=e.name?.split?.(".")?.pop?.()??".png";return new Promise((g,o)=>{const c=new FileReader;c.onload=async n=>{const l=new Image;if(n.target==null||n.target.result==null){o("e.target.result is null");return}l.src=n.target.result,await l.decode(),g({width:l.width,height:l.height,fileSize:e.size,fileExtension:i})},c.onerror=n=>o(n),c.readAsDataURL(e)})},j=()=>r(b,{size:"lg",thickness:"3px",color:"$primary9"}),G=e=>r(U,{get fallback(){return r(M,{mt:"$3",size:"xl",name:"+",class:"noselect no-drag",draggable:!1,borderRadius:"0.25em",get src(){return e.imageUrl}})},get children(){return[r(T,{get when(){return e.networkState===s.Loading},get children(){return r(p,{pt:"2em",get children(){return r(j,{})}})}}),r(T,{get when(){return e.networkState===s.Error},get children(){return r(E,{})}})]}});var J=D("<input id=file-upload type=file accept=image/*>");const v=(e,i)=>i??(e==null?_.fallbackImg:e?.toString?.()),K=e=>{let i;const[g,o]=O(e.validation),[c,n]=u(v(e.value,e.imageValue)),[l,I]=u(),[w,P]=u(),[V,h]=u(s.Success);f(()=>{e.showValidationMessages===!0&&o({...new File([],""),...l()})},[e.showValidationMessages]),f(async()=>{const t=w();if(t!=null)try{n(URL.createObjectURL(t));const a=await W(t);I(a),o({...t,...a}),e.onChange(t),h(s.Success)}catch{h(s.Error)}finally{P(void 0)}},[w]),f(()=>{e.value==null&&n(v(e.value,e.imageValue))},[e.value]);const F=async t=>{let a=null;if(t[0]==null){a="No files were supplied.";return}if(t.length>1){a="Too many files were supplied.";return}a!=null&&C.show({status:"danger",title:"File upload error!",description:a}),h(s.Loading),P(t[0])};return r(x,{get children(){return r(y,{direction:"column",class:"img-profile-hover pointer",onClick:()=>i?.click?.(),get children(){return[r(L,{textAlign:"center",get for(){return e.id},get children(){return[B(()=>e.label),r(q,{get helpText(){return e.helpText}})]}}),r(x,{h:"100%",get children(){return r(G,{get imageUrl(){return c()},get networkState(){return V()}})}}),r(p,{display:"none",get children(){var t=J();return $(t,"change",H(F)),z(a=>i=a,t),t}}),r(p,{mt:"$3",textAlign:"center",get children(){return r(S,{get invalid(){return!g().isValid},get children(){return r(A,{textAlign:"center",get children(){return g().errorMessage}})}})}})]}})}})},te={title:"Form/ProfilePic",component:K,decorators:[k],tags:["autodocs"],argTypes:{...R()}},d={args:{label:"Profile Pic",helpText:"This is a help icon with a tooltip",showValidationMessages:!0}},m={args:{label:"Bad Profile Pic",helpText:"This is a help icon with a tooltip",showValidationMessages:!0,validation:()=>({isValid:!1,errorMessage:"example error message"})}};d.parameters={...d.parameters,docs:{...d.parameters?.docs,source:{originalSource:`{
  args: {
    label: 'Profile Pic',
    helpText: 'This is a help icon with a tooltip',
    showValidationMessages: true
  }
}`,...d.parameters?.docs?.source}}};m.parameters={...m.parameters,docs:{...m.parameters?.docs,source:{originalSource:`{
  args: {
    label: 'Bad Profile Pic',
    helpText: 'This is a help icon with a tooltip',
    showValidationMessages: true,
    validation: () => ({
      isValid: false,
      errorMessage: 'example error message'
    })
  }
}`,...m.parameters?.docs?.source}}};const ae=["Basic","ValidationError"];export{d as Basic,m as ValidationError,ae as __namedExportsOrder,te as default};
