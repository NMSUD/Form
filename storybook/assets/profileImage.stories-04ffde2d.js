import{t as y,p as _,q as U,B as R,u as O,v as z,E as j,w as H,G as W,J as q,K as f,L as o,P as G,M as J,A as K,r as T,D as B,a as Q,F as X,C as $,c as Y,b as Z,N,O as ee,U as re,g as te}from"./debugNode-a24c225f.js";import{b as r,m as ae,f as P,s as x,t as g,g as I,c as m,e as b,M as E,k as ne,l as ie,u as le,S as se}from"./store-3f3d1d83.js";import{A as S}from"./image-d51ea353.js";import{u as oe}from"./useValidation-4ccae39f.js";import{H as ce}from"./helpIconTooltip-8b6048b3.js";import{M as V}from"./mediaUpload-da93fc8d.js";import"./_commonjsHelpers-725317a4.js";var c=(e=>(e[e.Pending=0]="Pending",e[e.Loading=1]="Loading",e[e.Success=2]="Success",e[e.Error=3]="Error",e))(c||{});const ge=e=>{const t=e.name?.split?.(".")?.pop?.()??".png";return new Promise((i,u)=>{const d=new FileReader;d.onload=async l=>{const s=new Image;if(l.target==null||l.target.result==null){u("e.target.result is null");return}s.src=l.target.result,await s.decode(),i({name:e.name,type:e.type,width:s.width,height:s.height,fileSize:e.size,fileExtension:t})},d.onerror=l=>u(l),d.readAsDataURL(e)})};var ue=g("<svg><circle cx=12 cy=12 r=10 fill=transparent stroke-width=1.5></svg>",!1,!0),de=g('<svg><path d="M12 17V11"stroke-width=1.5 stroke-linecap=round></svg>',!1,!0),me=g('<svg><circle cx=1 cy=1 r=1 transform="matrix(1 0 0 -1 11 9)"></svg>',!1,!0);const he=e=>r(_,ae({viewBox:"0 0 25 25"},e,{get children(){return[(()=>{var t=ue();return P(()=>x(t,"stroke",e.color?.toString?.()??y.primary)),t})(),(()=>{var t=de();return P(()=>x(t,"stroke",e.color?.toString?.()??y.primary)),t})(),(()=>{var t=me();return P(()=>x(t,"fill",e.color?.toString?.()??y.primary)),t})()]}}));var fe=g("<small>Image info"),pe=g("<small>kb"),k=g("<small>px");const ve=e=>r(G,{get children(){return[r(U,{as:R,variant:"subtle",colorScheme:"neutral",get children(){return[r(he,{mx:"auto",color:"white"}),"Â ",fe()]}}),r(O,{get children(){return[r(z,{}),r(j,{}),r(H,{get children(){return r(W,{dense:!0,get children(){return r(q,{get children(){return[r(f,{get children(){return[r(o,{children:"Extension"}),r(o,{get children(){return e.imageDetails?.type??e.imageDetails?.fileExtension}})]}}),r(f,{get children(){return[r(o,{children:"Size"}),r(o,{get children(){return[I(()=>Math.round((e.imageDetails?.fileSize??0)/1e3))," ",pe()]}})]}}),r(f,{get children(){return[r(o,{children:"Height"}),r(o,{get children(){return[I(()=>e.imageDetails?.height)," ",k()]}})]}}),r(f,{get children(){return[r(o,{borderBottom:"0",children:"Width"}),r(o,{borderBottom:"0",get children(){return[I(()=>e.imageDetails?.width)," ",k()]}})]}})]}})}})}})]}})]}}),be=()=>r(J,{size:"lg",thickness:"3px",color:"$primary9"}),we=e=>e==="[object Object]"||typeof e=="object"&&!Array.isArray(e)&&e!==null?S.fallbackImg:e,ye=e=>{const[t,i]=m(S.fallbackImg);return b(()=>{i(we(e.imageUrl))},[e.imageUrl]),r(ne,{get fallback(){return r(K,{mt:"$3",size:"xl",name:"+",class:"noselect no-drag",draggable:!1,borderRadius:"0.25em",get src(){return t()}})},get children(){return[r(E,{get when(){return e.networkState===c.Loading},get children(){return r(T,{py:"2em",get children(){return[r(B,{get name(){return t()}}),r(be,{})]}})}}),r(E,{get when(){return e.networkState===c.Error},get children(){return r(_,{})}})]}})},Pe={userDefault:250,backgroundDelay:1e3};var xe=g("<input id=file-upload type=file accept=image/*>");const A=(e,t)=>{if(t!=null)return t;const i=e?.file?.toString?.()??e?.url;return i??S.fallbackImg},Ie=e=>{let t;const[i,u]=oe(e.validation),[d,l]=m(A(e.value,e.imageValue)),[s,M]=m(),[D,F]=m(),[L,h]=m(c.Success);b(()=>{e.showValidationMessages===!0&&u({type:V.File,url:"",file:new File([],""),imageDetails:s()})},[e.showValidationMessages]),b(async()=>{const a=D();if(a!=null)try{const n=await ge(a),w={type:V.File,url:URL.createObjectURL(a),file:a,imageDetails:n};l(w.url),M(n),u(w),e.onChange(w),h(c.Success)}catch{h(c.Error)}finally{F(void 0)}},[D]),b(()=>{e.value==null&&(l(A(e.value,e.imageValue)),M(void 0))},[e.value]);const C=async a=>{let n=null;if(a[0]==null){n="No files were supplied.";return}if(a.length>1){n="Too many files were supplied.";return}if(n!=null){ee.show({status:"danger",title:"File upload error!",description:n}),h(c.Error);return}F(a[0])};return r($,{flexDirection:"column",get children(){return[r(B,{name:"FormProfileImageInput"}),r(Q,{direction:"column",class:"img-profile-hover pointer",onClick:()=>{t?.click?.(),setTimeout(()=>h(c.Loading),Pe.backgroundDelay)},get children(){return[r(X,{textAlign:"center",get for(){return e.id},get children(){return r(ce,{get label(){return e.label},get helpText(){return e.helpText}})}}),r($,{h:"100%",get children(){return r(ye,{get imageUrl(){return d()},get networkState(){return L()}})}}),r(T,{display:"none",get children(){var a=xe();return ie(a,"change",N(C)),le(n=>t=n,a),a}}),r(T,{my:"$1",textAlign:"center",get children(){return r(Y,{get invalid(){return!i().isValid},get children(){return r(Z,{textAlign:"center",get children(){return i().errorMessage}})}})}})]}}),r(se,{get when(){return s()!=null},get children(){return r(ve,{get imageDetails(){return s()}})}})]}})},Ve={title:"Form/ProfilePic",component:Ie,decorators:[re],tags:["autodocs"],argTypes:{...te()}},p={args:{label:"Profile Pic",helpText:"This is a help icon with a tooltip",showValidationMessages:!0}},v={args:{label:"Bad Profile Pic",helpText:"This is a help icon with a tooltip",showValidationMessages:!0,validation:()=>({isValid:!1,errorMessage:"example error message"})}};p.parameters={...p.parameters,docs:{...p.parameters?.docs,source:{originalSource:`{
  args: {
    label: 'Profile Pic',
    helpText: 'This is a help icon with a tooltip',
    showValidationMessages: true
  }
}`,...p.parameters?.docs?.source}}};v.parameters={...v.parameters,docs:{...v.parameters?.docs,source:{originalSource:`{
  args: {
    label: 'Bad Profile Pic',
    helpText: 'This is a help icon with a tooltip',
    showValidationMessages: true,
    validation: () => ({
      isValid: false,
      errorMessage: 'example error message'
    })
  }
}`,...v.parameters?.docs?.source}}};const ke=["Basic","ValidationError"];export{p as Basic,v as ValidationError,ke as __namedExportsOrder,Ve as default};
